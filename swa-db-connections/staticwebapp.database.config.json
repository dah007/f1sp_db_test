{
  "$schema": "https://github.com/Azure/data-api-builder/releases/latest/download/dab.draft.schema.json",
  "data-source": {
    "database-type": "mysql",
    "options": {},
    "connection-string": "@env('DATABASE_CONNECTION_STRING_F1SP')"
  },
  "runtime": {
    "rest": {
      "enabled": true,
      "path": "/rest"
    },
    "graphql": {
      "allow-introspection": true,
      "enabled": true,
      "path": "/graphql"
    },
    "host": {
      "mode": "production",
      "cors": {
        "origins": ["http://localhost:4280"],
        "allow-credentials": false
      },
      "authentication": {
        "provider": "StaticWebApps"
      }
    }
  },
  "entities": {
    "circuitWYear": {
      "source": {
        "type": "view",
        "key-fields": ["race_id"],
        "object": "circuit_w_race_year"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },
    "constructors": {
      "source": {
        "type": "view",
        "key-fields": ["id"],
        "object": "constructors_with_data"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },

    "driver": {
      "source": "driver",
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },

    "driverOfTheDay": {
      "source": {
        "type": "view",
        "key-fields": ["race_id"],
        "object": "dod_w_driver"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },

    "drivers": {
      "source": {
        "type": "view",
        "key-fields": ["id"],
        "object": "driver_w_data"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },
    "driversStandings": {
      "source": {
        "type": "view",
        "key-fields": ["id"],
        "object": "driver_w_standings"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },

    "engine_manufacturers": {
      "source": {
        "type": "view",
        "key-fields": ["id"],
        "object": "engine_manufacturers_w_country"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },
    "engines": {
      "source": {
        "type": "view",
        "key-fields": ["id"],
        "object": "engine_w_country"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },
    "tyres": {
      "source": {
        "type": "view",
        "key-fields": ["id"],
        "object": "tyre_manufacturer_w_data"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },
    "fastestLap": {
      "source": {
        "type": "view",
        "key-fields": ["race_id"],
        "object": "fastest_lap_w_driver"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    },
    "fastestLapsByYear": {
      "source": {
        "type": "view",
        "key-fields": ["year"],
        "object": "fastest_laps_by_year"
      },
      "permissions": [
        {
          "actions": ["read"],
          "role": "anonymous"
        }
      ]
    }
  }
}
